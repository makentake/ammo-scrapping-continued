Update and continuation of Permanoob's mod.